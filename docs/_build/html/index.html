
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Flask-MongoKit &mdash; Flask-MongoKit v0.2 documentation</title>
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Flask-MongoKit v0.2 documentation" href="#" /> 
  </head>
  <body>
  
  
  <div class=indexwrapper>
  


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="flask-mongokit">
<h1>Flask-MongoKit<a class="headerlink" href="#flask-mongokit" title="Permalink to this headline">¶</a></h1>
<p>Flask-MonogKit makes it easy to use <a class="reference external" href="http://namlook.github.com/mongokit/">MongoKit</a>, a powerful <a class="reference external" href="http://www.mongodb.org/">MongoDB</a> ORM
in Flask applications.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>The installation is thanks the Python Package Index and <a class="reference external" href="http://pip.openplans.org/">pip</a> really simple.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> pip install Flask-MongoKit
</pre></div>
</div>
<p>If you can only use <cite>easy_install</cite> than use</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> easy_install Flask-MongoKit
</pre></div>
</div>
<p>Flask-MongoKit requires to run some packages (they will be installed automated if they not already installed):</p>
<ul class="simple">
<li>Flask</li>
<li>MongoKit</li>
<li>pymongo</li>
</ul>
</div>
<div class="section" id="your-first-document">
<h2>Your first Document<a class="headerlink" href="#your-first-document" title="Permalink to this headline">¶</a></h2>
<p>It is very simple and fast to use MongoKit in your Flask application. Lets create a simple ToDo application</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span>
<span class="kn">from</span> <span class="nn">flaskext.mongokit</span> <span class="kn">import</span> <span class="n">MongoKit</span><span class="p">,</span> <span class="n">Document</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Task</span><span class="p">(</span><span class="n">Document</span><span class="p">):</span>
    <span class="n">__collection__</span> <span class="o">=</span> <span class="s">&#39;tasks&#39;</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="nb">unicode</span><span class="p">,</span>
        <span class="s">&#39;text&#39;</span><span class="p">:</span> <span class="nb">unicode</span><span class="p">,</span>
        <span class="s">&#39;creation&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="s">&#39;creation&#39;</span><span class="p">]</span>
    <span class="n">default_values</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;creation&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()}</span>
    <span class="n">use_dot_notation</span> <span class="o">=</span> <span class="bp">True</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MongoKit</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">register</span><span class="p">([</span><span class="n">Task</span><span class="p">])</span>
</pre></div>
</div>
<p>You can see we create a model (class Task) for our document and definied a structur, a list of required fields and default values. Also we say that we want to use a dot notation. To learn more about the definition of a Document look into the <a class="reference external" href="http://namlook.github.com/mongokit/descriptors.html">MongoKit documentation</a>.</p>
<p>Now we want that we can add a task over a form into our database.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/new&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;GET&quot;</span><span class="p">,</span> <span class="s">&quot;POST&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">new_task</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">task</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Task</span><span class="p">()</span>
        <span class="n">task</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span>
        <span class="n">task</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s">&#39;text&#39;</span><span class="p">]</span>
        <span class="n">task</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">&#39;show_all&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;new.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now if someone click now on the form button we create a new instance of our model Task and set in the next two lines title and text. After that we save the object into your database and redirect the visitor to the list of all task.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_all</span><span class="p">():</span>
    <span class="n">tasks</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Task</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;list.html&#39;</span><span class="p">,</span> <span class="n">tasks</span><span class="o">=</span><span class="n">tasks</span><span class="p">)</span>
</pre></div>
</div>
<p>With the find method we get now a list of task which is going to show on the index page.</p>
</div>
<div class="section" id="api-documentation">
<h2>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="flaskext.mongokit.MongoKit">
<em class="property">class </em><tt class="descclassname">flaskext.mongokit.</tt><tt class="descname">MongoKit</tt><big>(</big><em>app=None</em><big>)</big><a class="headerlink" href="#flaskext.mongokit.MongoKit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="flaskext.mongokit.MongoKit.registered_documents">
<tt class="descname">registered_documents</tt><a class="headerlink" href="#flaskext.mongokit.MongoKit.registered_documents" title="Permalink to this definition">¶</a></dt>
<dd><p>list of MongoKit.Document which will be automated registed at
connection</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  

  
  </div>
  

  </body>
</html>